SELECT MIN(TRANSACTION_TIME) FROM COFFEE_SHOP;

SELECT MAX(TRANSACTION_TIME) FROM COFFEE_SHOP; SELECT * FROM COFFEE_SHOP; -- COUNT THE NUMBER OF SALES-- SELECT COUNT(TRANSACTION_ID) FROM COFFEE_SHOP;

--COUNT UNIQUE NUMBER OF SALES AS THE TOTAL NUMBER OF SALES-- SELECT DISTINCT COUNT(TRANSACTION_ID) AS NUMBER_OF_TOTAL_SALES FROM COFFEE_SHOP;

-- COUNT DISTINCT PRODUCT-- SELECT * FROM COFFEE_SHOP;

--unique store location-- SELECT DISTINCT(STORE_LOCATION) FROM COFFEE_SHOP;

SELECT STORE_LOCATION, SUM(TOTAL_AMOUNT) AS SALES_REVENUE FROM COFFEE_SHOP GROUP BY STORE_LOCATION ORDER BY SALES_REVENUE DESC;

SELECT DISTINCT(PRODUCT_CATEGORY) AS UNIQUE_PRODUCT_SOLD

FROM COFFEE_SHOP;

--TOP SELLING PRODUCT BY PRODUCT_CATEGORY-- SELECT PRODUCT_CATEGORY, SUM(TRANSACTION_QTY) AS TOTAL_QUANTITY_SOLD FROM COFFEE_SHOP GROUP BY PRODUCT_CATEGORY ORDER BY TOTAL_QUANTITY_SOLD DESC LIMIT 10;

-- BY PRODUCT_TYPE-- SELECT PRODUCT_TYPE, SUM(TRANSACTION_QTY) AS TOTAL_QUANTITY_SOLD FROM COFFEE_SHOP GROUP BY PRODUCT_TYPE ORDER BY TOTAL_QUANTITY_SOLD DESC;

-- BY PRODUCT_TYPE ASC-- SELECT PRODUCT_TYPE, SUM(TRANSACTION_QTY) AS TOTAL_QUANTITY_SOLD FROM COFFEE_SHOP GROUP BY PRODUCT_TYPE ORDER BY TOTAL_QUANTITY_SOLD ASC;

SELECT * FROM COFFEE_SHOP;

--PRODUCT SELLS MORE AND WHICH TIME-- SELECT EXTRACT( HOUR FROM TRANSACTION_TIME) AS HOUR_OR_DAY, PRODUCT_ID, PRODUCT_CATEGORY, SUM(TRANSACTION_QTY) AS Quantity_sold FROM COFFEE_SHOP GROUP BY ALL;

SELECT TRANSACTION_DATE, TO_CHAR(TO_DATE(TRANSACTION_DATE,'YYYY/MM/DD'),'YYYYMM') AS Month_ID, COUNT(TRANSACTION_ID)AS Number_of_sales, COUNT(PRODUCT_ID)AS Unique_products_sold, Total_Amount, PRODUCT_CATEGORY, PRODUCT_DETAIL, PRODUCT_TYPE, STORE_LOCATION, CASE WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'Morning' WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '16:59:59' THEN 'Afternoon' WHEN TRANSACTION_TIME BETWEEN '17:00:00' AND '19:59:59' THEN 'Evening' ELSE 'Night' END as time_buckets FROM COFFEE_SHOP GROUP BY ALL;

SELECT SUM(TOTAL_AMOUNT) FROM COFFEE_SHOP;
